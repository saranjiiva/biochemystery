<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Slides Library Viewer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: "Segoe UI", Arial, sans-serif;
  background: #0f172a;
  color: white;
  overflow: hidden;
}

.app {
  display: flex;
  height: 100vh;
  width: 100vw;
}

/* Sidebar */
.sidebar {
  width: 280px;
  background: #020617;
  border-right: 1px solid #1e293b;
  display: flex;
  flex-direction: column;
}

.sidebar-header {
  padding: 14px 16px;
  font-weight: bold;
  border-bottom: 1px solid #1e293b;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.sidebar-header button {
  background: #0ea5e9;
  border: none;
  color: white;
  padding: 6px 10px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 12px;
}
.sidebar-header button:hover {
  background: #0284c7;
}

.deck-list, .slide-list {
  overflow-y: auto;
}

.deck-item {
  padding: 12px 16px;
  cursor: pointer;
  border-bottom: 1px solid #020617;
  font-size: 14px;
  color: #cbd5f5;
}
.deck-item:hover {
  background: #1e293b;
}
.deck-item.active {
  background: #0ea5e9;
  color: white;
  font-weight: bold;
}

.slide-item {
  padding: 10px 20px;
  cursor: pointer;
  border-bottom: 1px solid #020617;
  font-size: 13px;
  color: #94a3b8;
}
.slide-item:hover {
  background: #1e293b;
}
.slide-item.active {
  background: #334155;
  color: white;
}

/* Viewer */
.viewer {
  flex: 1;
  background: #020617;
  display: flex;
  flex-direction: column;
}

.viewer-toolbar {
  height: 56px;
  background: #020617;
  border-bottom: 1px solid #1e293b;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 16px;
}

.viewer-toolbar .left,
.viewer-toolbar .right {
  display: flex;
  align-items: center;
  gap: 10px;
}

.viewer-toolbar button {
  background: #1e293b;
  border: none;
  color: white;
  padding: 8px 14px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
}
.viewer-toolbar button:hover {
  background: #334155;
}

.slide-counter {
  font-size: 13px;
  color: #cbd5f5;
}

.viewer-stage {
  flex: 1;
  background: #020617;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
}

.slide-frame {
  width: 1280px;
  height: 720px;
  border: 1px solid #1e293b;
  background: white;
  box-shadow: 0 0 40px rgba(0,0,0,0.6);
}

.slide-frame iframe,
.slide-frame img {
  width: 100%;
  height: 100%;
  border: none;
  object-fit: contain;
  background: white;
}

/* Fullscreen */
.fullscreen .sidebar,
.fullscreen .viewer-toolbar {
  display: none;
}
.fullscreen .viewer-stage {
  background: black;
}
.fullscreen .slide-frame {
  width: 100vw;
  height: 100vh;
  border: none;
  box-shadow: none;
}

/* Mobile */
@media (max-width: 900px) {
  .sidebar { width: 220px; }
  .slide-frame {
    width: 90vw;
    height: calc(90vw * 9 / 16);
  }
}
</style>
</head>
<body>

<div class="app" id="app">

  <!-- Sidebar -->
  <div class="sidebar">

    <div class="sidebar-header">
      ðŸ“š Slide Library
      <button onclick="uploadDeck()">âž• Upload PPT</button>
      <input type="file" id="pptInput" accept=".ppt,.pptx" hidden>
    </div>

    <div class="deck-list" id="deckList"></div>
    <div class="slide-list" id="slideList"></div>

  </div>

  <!-- Viewer -->
  <div class="viewer">

    <div class="viewer-toolbar">
      <div class="left">
        <button onclick="prevSlide()">â¬… Prev</button>
        <button onclick="nextSlide()">Next âž¡</button>
      </div>

      <div class="center slide-counter" id="counter">â€“ / â€“</div>

      <div class="right">
        <button onclick="toggleFullscreen()">â›¶ Fullscreen</button>
        <button onclick="exitViewer()">âœ– Close</button>
      </div>
    </div>

    <div class="viewer-stage">
      <div class="slide-frame" id="slideFrameContainer"></div>
    </div>

  </div>

</div>

<script>
/* ================================
   DATA STRUCTURE
   Each deck = one PPT
   Each deck contains slide URLs
================================ */

let decks = [
  {
    title: "TCA Cycle",
    slides: [
      "slides/tca/slide1.html",
      "slides/tca/slide2.html",
      "slides/tca/slide3.html",
      "slides/tca/slide4.html"
    ]
  },
  {
    title: "Glycolysis",
    slides: [
      "slides/glycolysis/slide1.html",
      "slides/glycolysis/slide2.html",
      "slides/glycolysis/slide3.html"
    ]
  }
];

let currentDeck = 0;
let currentSlide = 0;

const deckList = document.getElementById("deckList");
const slideList = document.getElementById("slideList");
const counter = document.getElementById("counter");
const slideFrameContainer = document.getElementById("slideFrameContainer");
const pptInput = document.getElementById("pptInput");
const app = document.getElementById("app");

/* ================================
   BUILD SIDEBAR
================================ */

function buildDeckList() {
  deckList.innerHTML = "";
  decks.forEach((deck, i) => {
    const div = document.createElement("div");
    div.className = "deck-item";
    div.textContent = deck.title;
    div.onclick = () => loadDeck(i);
    deckList.appendChild(div);
  });
}

function buildSlideList() {
  slideList.innerHTML = "";
  const slides = decks[currentDeck].slides;

  slides.forEach((_, i) => {
    const div = document.createElement("div");
    div.className = "slide-item";
    div.textContent = `Slide ${i + 1}`;
    div.onclick = () => loadSlide(i);
    slideList.appendChild(div);
  });
}

/* ================================
   LOADERS
================================ */

function loadDeck(index) {
  currentDeck = index;
  currentSlide = 0;
  buildSlideList();
  loadSlide(0);
  updateDeckUI();
}

function loadSlide(index) {
  currentSlide = index;
  const url = decks[currentDeck].slides[index];

  slideFrameContainer.innerHTML = "";

  if (url.endsWith(".html")) {
    const iframe = document.createElement("iframe");
    iframe.src = url;
    slideFrameContainer.appendChild(iframe);
  } else {
    const img = document.createElement("img");
    img.src = url;
    slideFrameContainer.appendChild(img);
  }

  updateUI();
}

/* ================================
   UI UPDATE
================================ */

function updateUI() {
  document.querySelectorAll(".slide-item").forEach((el, i) => {
    el.classList.toggle("active", i === currentSlide);
  });
  counter.textContent = `${currentSlide + 1} / ${decks[currentDeck].slides.length}`;
}

function updateDeckUI() {
  document.querySelectorAll(".deck-item").forEach((el, i) => {
    el.classList.toggle("active", i === currentDeck);
  });
}

/* ================================
   NAVIGATION
================================ */

function nextSlide() {
  if (currentSlide < decks[currentDeck].slides.length - 1) {
    loadSlide(currentSlide + 1);
  }
}

function prevSlide() {
  if (currentSlide > 0) {
    loadSlide(currentSlide - 1);
  }
}

/* ================================
   FULLSCREEN
================================ */

function toggleFullscreen() {
  app.classList.toggle("fullscreen");
}

/* ================================
   EXIT
================================ */

function exitViewer() {
  window.location.href = "index.html";
}

/* ================================
   KEYBOARD
================================ */

document.addEventListener("keydown", e => {
  if (e.key === "ArrowRight") nextSlide();
  if (e.key === "ArrowLeft") prevSlide();
  if (e.key === "f" || e.key === "F") toggleFullscreen();
  if (e.key === "Escape") app.classList.remove("fullscreen");
});

/* ================================
   PPT UPLOAD HANDLER (FRONTEND)
================================ */

function uploadDeck() {
  pptInput.click();
}

pptInput.addEventListener("change", () => {
  const file = pptInput.files[0];
  if (!file) return;

  alert(
    "Browsers cannot directly read PPT files.\n\n" +
    "This upload is sent to backend for conversion into slides.\n\n" +
    "I will give you the converter server next."
  );

  pptInput.value = "";
});

/* ================================
   INIT
================================ */

buildDeckList();
loadDeck(0);
</script>

</body>
</html>
